<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Impiccato</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">

    <style>
        .container {
            min-width: 800px;
            max-width: 1000px;
        }
    </style>
</head>

<body>
    <div class="container">
        <nav class="navbar mb-4">
            <div class="container-fluid d-flex justify-content-between">
                <a class="navbar-brand d-flex" href="#">
                    <img src="./immagini/impiccato.jfif" alt="Logo" height="75" class="d-inline-block align-text-top">
                    <p class="fs-2 align-self-center ps-3">IMPICCATO</p>
                </a>
                <div>
                    <button type="button" class="btn btn-lg btn-danger" id="reset">Reset</button>
                </div>
            </div>
        </nav>

        <div class="d-flex mb-4">
            <div class="fs-4">
                <svg xmlns="http://www.w3.org/2000/svg" height="25" fill="currentColor" class="bi bi-trophy" viewBox="0 0 16 16">
                    <path d="M2.5.5A.5.5 0 0 1 3 0h10a.5.5 0 0 1 .5.5q0 .807-.034 1.536a3 3 0 1 1-1.133 5.89c-.79 1.865-1.878 2.777-2.833 3.011v2.173l1.425.356c.194.048.377.135.537.255L13.3 15.1a.5.5 0 0 1-.3.9H3a.5.5 0 0 1-.3-.9l1.838-1.379c.16-.12.343-.207.537-.255L6.5 13.11v-2.173c-.955-.234-2.043-1.146-2.833-3.012a3 3 0 1 1-1.132-5.89A33 33 0 0 1 2.5.5m.099 2.54a2 2 0 0 0 .72 3.935c-.333-1.05-.588-2.346-.72-3.935m10.083 3.935a2 2 0 0 0 .72-3.935c-.133 1.59-.388 2.885-.72 3.935M3.504 1q.01.775.056 1.469c.13 2.028.457 3.546.87 4.667C5.294 9.48 6.484 10 7 10a.5.5 0 0 1 .5.5v2.61a1 1 0 0 1-.757.97l-1.426.356a.5.5 0 0 0-.179.085L4.5 15h7l-.638-.479a.5.5 0 0 0-.18-.085l-1.425-.356a1 1 0 0 1-.757-.97V10.5A.5.5 0 0 1 9 10c.516 0 1.706-.52 2.57-2.864.413-1.12.74-2.64.87-4.667q.045-.694.056-1.469z"/>
                </svg>
                Vittorie : <span id="vittorie">0</span>
            </div>
        </div>

        <div class="mb-4">
            <div class="d-flex justify-content-center" id="divImmagine">
                <img src="immagini/HangMan_01.gif" class="img-thumbnail col-3">

            </div>
            
            <div class="d-flex justify-content-center">
                <p class="fs-1" id="parola"></p>
            </div>
            
            <div class="d-flex justify-content-center">
                <button type="button" class="btn btn-lg btn-success d-none" id="ancora">Ancora</button>

            </div>

        </div>

        <div class="container text-center">
            <div class="row row-cols-6">
                <button type="button" class="col-1 btn btn-secondary fs-2 m-1 lettera">A</button>
                <button type="button" class="col-1 btn btn-secondary fs-2 m-1 lettera">B</button>
                <button type="button" class="col-1 btn btn-secondary fs-2 m-1 lettera">C</button>
                <button type="button" class="col-1 btn btn-secondary fs-2 m-1 lettera">D</button>
                <button type="button" class="col-1 btn btn-secondary fs-2 m-1 lettera">E</button>
                <button type="button" class="col-1 btn btn-secondary fs-2 m-1 lettera">F</button>
                <button type="button" class="col-1 btn btn-secondary fs-2 m-1 lettera">G</button>
                <button type="button" class="col-1 btn btn-secondary fs-2 m-1 lettera">H</button>
                <button type="button" class="col-1 btn btn-secondary fs-2 m-1 lettera">I</button>
                <button type="button" class="col-1 btn btn-secondary fs-2 m-1 lettera">J</button>
                <button type="button" class="col-1 btn btn-secondary fs-2 m-1 lettera">K</button>
                <button type="button" class="col-1 btn btn-secondary fs-2 m-1 lettera">L</button>
                <button type="button" class="col-1 btn btn-secondary fs-2 m-1 lettera">M</button>
                <button type="button" class="col-1 btn btn-secondary fs-2 m-1 lettera">N</button>
                <button type="button" class="col-1 btn btn-secondary fs-2 m-1 lettera">O</button>
                <button type="button" class="col-1 btn btn-secondary fs-2 m-1 lettera">P</button>
                <button type="button" class="col-1 btn btn-secondary fs-2 m-1 lettera">Q</button>
                <button type="button" class="col-1 btn btn-secondary fs-2 m-1 lettera">R</button>
                <button type="button" class="col-1 btn btn-secondary fs-2 m-1 lettera">S</button>
                <button type="button" class="col-1 btn btn-secondary fs-2 m-1 lettera">T</button>
                <button type="button" class="col-1 btn btn-secondary fs-2 m-1 lettera">U</button>
                <button type="button" class="col-1 btn btn-secondary fs-2 m-1 lettera">V</button>
                <button type="button" class="col-1 btn btn-secondary fs-2 m-1 lettera">W</button>
                <button type="button" class="col-1 btn btn-secondary fs-2 m-1 lettera">X</button>
                <button type="button" class="col-1 btn btn-secondary fs-2 m-1 lettera">Y</button>
                <button type="button" class="col-1 btn btn-secondary fs-2 m-1 lettera">Z</button>

            </div>
        </div>

    </div>

    <script>
        let parole = ["Gatto", "Cane", "Capybara", "Balena", "Squalo", "Leone", "Giraffa"];
        let immagini = ["./immagini/HangMan_01.gif", "./immagini/HangMan_02.gif", "./immagini/HangMan_03.gif", "./immagini/HangMan_04.gif",
            "./immagini/HangMan_05.gif", "./immagini/HangMan_06.gif", "./immagini/HangMan_07.gif", "./immagini/HangMan_08.gif",
            "./immagini/HangMan_09.gif", "./immagini/HangMan_10.gif"
        ]
        let fineImm = ["./immagini/HangMan_LOSE.gif", "./immagini/HangMan_WIN.gif"];

        let paragrafo = document.getElementById("parola");
        let divImmagine = document.getElementById("divImmagine");

        class impiccato {
            parola;
            lettere;
            indiceImm;
            fine;

            constructor() {
                this.parola = parole[Math.floor(Math.random() * parole.length)];
                console.log(this.parola);

                this.lettere = [];
                this.indiceImm = 0;
                this.fine = false;

                this.caricaParola();
                this.caricaImmagine();

                document.getElementById("ancora").className = "btn btn-lg btn-success d-none";
            }

            caricaParola() {
                let finito = true;

                paragrafo.innerHTML = "";
                for (let i = 0; i < this.parola.length; i++) {
                    if (this.lettere.includes(this.parola[i].toLowerCase())) paragrafo.innerHTML += this.parola[i] + " ";
                    else {
                        paragrafo.innerHTML += "_ ";
                        finito = false;
                    }
                }

                return finito;
            }

            caricaImmagine() {
                let img = document.createElement("img");

                if (this.fine) {
                    if (this.indiceImm == immagini.length) img.setAttribute("src", fineImm[0]);
                    else img.setAttribute("src", fineImm[1]);
                }
                else {
                    img.setAttribute("src", immagini[this.indiceImm]);
                }

                img.className = "img-thumbnail col-3";
                divImmagine.innerHTML = "";
                divImmagine.appendChild(img);
            }

            addLettera(lettera) {
                this.lettere.push(lettera.toLowerCase());
                console.log(this.lettere);
                this.caricaParola();
            }

            risolvi() {
                paragrafo.innerHTML = "";
                for (let i = 0; i < this.parola.length; i++) {
                    paragrafo.innerHTML += this.parola[i] + " ";
                }
            }

            controller(lettera) {
                if (!this.fine) {
                    if (this.lettere.includes(lettera.toLowerCase()) || !this.parola.toLowerCase().includes(lettera.toLowerCase())) {
                        console.log("sbagliato");
                        this.indiceImm++;

                        if (this.indiceImm == immagini.length) {
                            this.fine = true;
                            this.risolvi();
                        }

                        this.caricaImmagine();
                    }
                    else {
                        this.addLettera(lettera);

                        if (this.caricaParola()) {
                            this.fine = true;
                            this.caricaImmagine();
                            document.getElementById("vittorie").innerHTML = parseInt(document.getElementById("vittorie").innerHTML)+1;
                            document.getElementById("ancora").className = "btn btn-lg btn-success";
                        }
                    }

                }
            }

        }

        let gioco = new impiccato();

        let bottoni = document.querySelectorAll("button.lettera");
        bottoni.forEach(bottone => {
            bottone.addEventListener("click", (event) => {
                gioco.controller(event.target.innerHTML);
                event.target.className = event.target.className.replace("btn-secondary", "bg-secondary");
                event.target.style = "--bs-bg-opacity: .3;";
            });
        });

        document.getElementById("reset").addEventListener("click", () => {
            pulisci();
            document.getElementById("vittorie").innerHTML = "0";
        });

        document.getElementById("ancora").addEventListener("click", () => {
            pulisci();
        });

        function pulisci() {
            gioco = new impiccato();

            bottoni.forEach(bottone => {
                bottone.className = bottone.className.replace("bg-secondary", "btn-secondary");
                bottone.style = "";
            });
        }

    </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
        crossorigin="anonymous"></script>
</body>

</html>